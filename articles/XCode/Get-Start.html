<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>&#25171;&#24320;Visual Studio&#65292;&#26032;&#24314;&#19968;&#20010;&#25511;&#21046;&#21488;&#24212;&#29992; </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="&#25171;&#24320;Visual Studio&#65292;&#26032;&#24314;&#19968;&#20010;&#25511;&#21046;&#21488;&#24212;&#29992; ">
    <meta name="generator" content="docfx 2.36.2.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../images/logo.png" alt="" style="
                  width: 40px;
                  margin-top: 5px;">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h3 id="打开visual-studio新建一个控制台应用">打开Visual Studio，新建一个控制台应用</h3>

<h3 id="使用nuget安装到你的项目">使用NuGet安装到你的项目</h3>
<p>PM&gt; Install-Package NewLife.XCode</p>
<h3 id="编写一个简单xml模型如果你已有现成的数据库则可以使用xcoderexe工具生成">编写一个简单Xml模型（如果你已有现成的数据库，则可以使用XCoder.exe工具生成）</h3>
<pre><code class="lang-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;Tables Version=&quot;9.6.6644.19804&quot; Output=&quot;MyEntity&quot; NameSpace=&quot;Model&quot; BaseClass=&quot;Entity&quot; ConnName=&quot;DB&quot;&gt;
  &lt;Table Name=&quot;UserInfo&quot; Description=&quot;用户信息&quot;&gt;
    &lt;Columns&gt;
      &lt;Column Name=&quot;UserId&quot; DataType=&quot;Int32&quot; Identity=&quot;True&quot; PrimaryKey=&quot;True&quot; Description=&quot;会员id&quot; /&gt;
      &lt;Column Name=&quot;UserName&quot; DataType=&quot;String&quot; Nullable=&quot;False&quot; Description=&quot;会员名称&quot; /&gt;
      &lt;Column Name=&quot;Password&quot; DataType=&quot;String&quot; Nullable=&quot;False&quot; Description=&quot;会员密码&quot; /&gt;
      &lt;Column Name=&quot;Age&quot; DataType=&quot;Int32&quot; Description=&quot;会员年龄&quot; /&gt;
    &lt;/Columns&gt;
  &lt;/Table&gt;
&lt;/Tables&gt;
</code></pre>
<p>这是一个简单的XCode映射模型，跟hibernate原理相似，依靠这个模型，我们可以自动生成我们想要的数据库而不用写任何sql语句，所以也不用打开你的Sqlserver管理工具、navicat、mysqladminister等等
，这个xml会自动帮你生成，一切都来得如此简单快捷。</p>
<h3 id="生成c模型">生成C#模型</h3>
<ul>
<li>右击 生成实体类.tt 文件,选择“运行自定义工具”，单击右上角的“显示所有文件”，这时你会看到
生成一个MyEntity文件目录，目录包含了两个文件：用户信息.Biz.cs、用户信息.cs，然后右击文件夹，选择“包括在项目中”，我们可以大概预览一下里面的
代码。作为一个orm组件，你完全不用关心里面代码的写法，我们只需会用就行了。</li>
</ul>
<h3 id="使用xcode实现简单的增删改查">使用XCode实现简单的增删改查</h3>
<ul>
<li>Program.cs文件最上面</li>
</ul>
<pre><code>using XCode.Code;
</code></pre>
<p>不然会使用不了Save、Update、Delete等扩展方法。</p>
<ul>
<li>新增一条数据。注：这里没有指定数据库，所以XCode默认的是sqlite数据库</li>
</ul>
<pre><code class="lang-csharp">            var user = new UserInfo();
            user.UserName = &quot;张三&quot;;
            user.Password = &quot;123456&quot;;
            user.Age = 18;
            user.Insert();//user.Save()等效

            Console.WriteLine(&quot;插入一条新数据，用户id为：&quot; + user.UserId);
</code></pre>
<ul>
<li>修改一条数据</li>
</ul>
<pre><code class="lang-csharp">            var user = new UserInfo();// var user = UserInfo.FindByUserId(1);
            user.UserId = 1;
            user.UserName = &quot;张三&quot;;
            user.Password = &quot;123456&quot;;
            user.Age = 19;
            user.Update();//user.Save()等效

            user = UserInfo.FindByUserId(1);
            Console.WriteLine($&quot;用户ID={user.UserId}已修改岁数，岁数为：{user.Age}&quot;);
</code></pre>
<ul>
<li>删除一条数据</li>
</ul>
<pre><code class="lang-csharp">            var user = new UserInfo();// var user = UserInfo.FindByUserId(1);
            user.UserId = 1;
            user.Delete();

            user = UserInfo.FindByUserId(1);
            Console.WriteLine(&quot;用户&quot; + (user == null ? &quot;已删除&quot; : &quot;还存在&quot;));
</code></pre>
<ul>
<li>查询数据，查询是一个十分复杂的需求，这里只举一些简单的例子，如果你想学更高级更复杂的查询，可以浏览页面底部的链接</li>
</ul>
<pre><code class="lang-csharp">            //根据UserId查询用户信息
            var userId = 2;
            var user = UserInfo.FindByUserId(userId);
            Console.WriteLine($&quot;ID为{user.UserId}用户姓名为：{user.UserName}&quot;);

            //根据用户名称查询
            var userList= UserInfo.FindAll(UserInfo._.UserName, &quot;张三&quot;);
            Console.WriteLine($&quot;查询符合姓名为张三的记录有{userList.Count}&quot;);

            //多复合条件查询
            userList = UserInfo.FindAll(UserInfo._.UserName == &quot;张三&quot; &amp; UserInfo._.Age == 19);
            Console.WriteLine($&quot;查询符合姓名为张三年龄为19的记录有{userList.Count}&quot;);

</code></pre>
<h2 id="一些高级的用法">一些高级的用法</h2>
<ul>
<li>更新（注：XCode是使用缓存，所以有些高级方法会绕过缓存直接更新数据库，这样会导致缓存数据与数据库的数据不一致。）
更新某些字段。</li>
</ul>
<pre><code class="lang-csharp">            UserInfo.Update(UserInfo._.UserName == &quot;李四&quot; &amp; UserInfo._.Age == 18, UserInfo._.UserId == 1);
            // 相当于Update UserInfo Set UserName='李四' And Age=18 Where UserId=1
            // 绕过了缓存，不推荐这种写法。建议先查出来对象，然后修改并Update回去
</code></pre>
<p>复杂的查询语句</p>
<pre><code class="lang-csharp">            var userList = UserInfo.FindAll(UserInfo._.UserName == &quot;张三&quot; &amp; UserInfo._.Age == 19, UserInfo._.UserName.Desc(), string.Join(&quot;,&quot;, UserInfo._.UserName, UserInfo._.Age), 0, 0);
            // 相当于Select UserName,Age From UserInfo Where UserName='张三' And Age=19 Order By  UserName desc
</code></pre>
<p>带分页排序的复杂查询<br>
一般写在实体类业务文件（.Biz.cs）里面</p>
<pre><code class="lang-csharp">public static IList&lt;UserInfo&gt; Search(String name, Int32 age, Pager p)
{
    // 多条件复杂查询
    var exp = new WhereExpression();
    if(!name.IsNullOrEmpty()) exp &amp;= _.UserName == name;
    if(age &gt; 0) exp &amp;= _.Age == age;

    return FindAll(exp, p);
}

void Test()
{
    // 默认第一页，每页20行。魔方NewLife.Cube自动从页面Request获取以下参数
    var p = new Pager();
    p.PageIndex = 3;
    p.PageSize = 10;
    p.Sort = UserInfo.__.Age;
    p.Desc = true;

    // 需要总记录数来分页，FindAll后p.TotalCount有总记录数，用于计算页数PageCount
    p.RetrieveTotalCount = true;

    // 相当于Select * From UserInfo Where UserName='张三' And Age=19 Order By Age Desc limit 20, 10
    var list = UserInfo.Search(&quot;张三&quot;, 19, p);
}
</code></pre>
<p>以上的分页有缺点，就是只应用单字段排序</p>
<p>复合排序的分页查询语句</p>
<pre><code class="lang-csharp">    var pageIndex = 2;//第二页
    var pageSize = 10;//每页十行

    var userList = UserInfo.FindAll(UserInfo._.UserName == &quot;张三&quot; &amp; UserInfo._.Age == 19, &quot; UserName desc,Age asc&quot;, string.Join(&quot;,&quot;, UserInfo._.UserName, UserInfo._.Age), (pageIndex - 1) * pageSize, pageSize);
    //相当于Select UserName,Age From UserInfo Where UserName='张三' And Age=19 Order By  UserName desc,Age asc limit 10, 10
</code></pre>
<h2 id="更多">更多</h2>
<p>因为时间有限，只写了一些简单的例子，这个markdown会持续更新，敬请期待</p>
<h2 id="相关教程">相关教程</h2>
<ul>
<li>初级
<a href="http://www.cnblogs.com/nnhy/archive/2010/09/13/1824666.html">ORM组件XCode（简介）</a><br>
<a href="http://www.cnblogs.com/nnhy/archive/2010/09/15/1826602.html">ORM组件XCode（动手）</a></li>
</ul>
<hr>
<ul>
<li>系列
<a href="http://www.cnblogs.com/JangoJing/archive/2012/07/26/2610034.html">NewLife.XCode 上手指南</a><br>
<a href="http://www.cnblogs.com/JangoJing/archive/2012/07/26/2610368.html">NewLife.XCode 上手指南(二) 反向工程使用举例</a><br>
<a href="http://www.cnblogs.com/JangoJing/archive/2012/07/31/2616238.html">NewLife.Xcode 上手指南(三) 扩展属性的使用</a><br>
<a href="http://www.cnblogs.com/JangoJing/archive/2012/08/02/2619311.html">NewLife.XCode 上手指南(四) 级联操作</a><br>
<a href="http://www.cnblogs.com/JangoJing/archive/2012/08/17/2644124.html">NewLife.XCode 上手指南(五) 复杂查询</a></li>
</ul>
<hr>
<ul>
<li>进阶</li>
</ul>
<blockquote>
<p><a href="http://www.cnblogs.com/nnhy/archive/2010/09/25/1834320.html">充血模型的ORM能做什么？——ORM组件XCode（十八般武艺）</a><br>
<a href="http://www.cnblogs.com/nnhy/archive/2012/04/27/2473052.html">NewLife.XCode中如何借助分部抽象多个具有很多共同字段的实体类</a><br>
<a href="http://www.cnblogs.com/nnhy/archive/2010/09/15/1827477.html">ORM组件XCode（撬动千万级数据）</a><br>
<a href="http://www.cnblogs.com/nnhy/archive/2010/09/15/1826602.html">ORM组件XCode（动手）</a></p>
</blockquote>
<h4 id="新生命开发团队">新生命开发团队</h4>
<p>网站：http://www.NewLifeX.com<br>
QQ群：1600800</p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/xxred/XDoc/blob/master/articles/XCode/Get-Start.MD/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
